if(typeof global==="undefined")global=window;var Q$Externals={};Q$Externals.formatDayHourAndMin=function(t){if(t===0)return"0";else if(!t)return"";var e=Math.floor(t/24/60);var r="";if(e>0){r+=e.toString()}var n=$.pi.zeroPad(Math.floor(t%(24*60)/60),2)+":"+$.pi.zeroPad(t%60,2);if(n!="00:00"){if(e>0)r+=".";r+=n}return r};Q$Externals.formatISODateTimeUTC=function(t){if(t==null)return"";var e=function(t){return(t<10?"0":"")+t};var r=t.getUTCFullYear()+"-"+e(t.getUTCMonth()+1)+"-"+e(t.getUTCDate())+"T"+e(t.getUTCHours())+":"+e(t.getUTCMinutes());var n=Number(t.getUTCSeconds()+"."+(t.getUTCMilliseconds()<100?"0":"")+e(t.getUTCMilliseconds()));r+=":"+e(n)+"Z";return r};Q$Externals.formatNumber=function(t,e,r,n){var a="-";if(isNaN(t)){return null}var i="";if(e.indexOf(".")>-1){var l=r;var o=e.substring(e.lastIndexOf(".")+1);t=new Number(Q$Externals.roundNumber(t,o.length));var s=t%1;var u=new String(s.toFixed(o.length));u=u.substring(u.lastIndexOf(".")+1);for(var d=0;d<o.length;d++){if(o.charAt(d)=="#"&&u.charAt(d)!="0"){l+=u.charAt(d);continue}else if(o.charAt(d)=="#"&&u.charAt(d)=="0"){var f=u.substring(d);if(f.match("[1-9]")){l+=u.charAt(d);continue}else break}else if(o.charAt(d)=="0")l+=u.charAt(d)}i+=l}else t=Math.round(t);var c=Math.floor(t);if(t<0)c=Math.ceil(t);var p="";if(e.indexOf(".")==-1)p=e;else p=e.substring(0,e.indexOf("."));var h="";if(!(c==0&&p.substr(p.length-1)=="#")){var g=new String(Math.abs(c));var v=9999;if(p.lastIndexOf(",")!=-1)v=p.length-p.lastIndexOf(",")-1;var $=0;for(var d=g.length-1;d>-1;d--){h=g.charAt(d)+h;$++;if($==v&&d!=0){h=n+h;$=0}}if(p.length>h.length){var m=p.indexOf("0");if(m!=-1){var x=p.length-m;var Q=p.length-h.length-1;while(h.length<x){var y=p.charAt(Q);if(y==",")y=n;h=y+h;Q--}}}}if(!h&&p.indexOf("0",p.length-1)!==-1)h="0";i=h+i;if(t<0)i=a+i;if(i.lastIndexOf(r)==i.length-1){i=i.substring(0,i.length-1)}return i};Q$Externals.roundNumber=function(t,e){var r=Math.pow(10,e||0);var n=String(Math.round(t*r)/r);if(e>0){var a=n.indexOf(".");if(a==-1){n+=".";a=0}else{a=n.length-(a+1)}while(a<e){n+="0";a++}}return n};Q$Externals.isoRegexp=/(\d{4,})(?:-(\d{1,2})(?:-(\d{1,2})(?:[T ](\d{1,2}):(\d{1,2})(?::(\d{1,2})(?:\.(\d+))?)?(?:(Z)|([+-])(\d{1,2})(?::(\d{1,2}))?)?)?)?)?/;Q$Externals.logDateToString=function(t){if(t){return Q.formatDate(Q$Externals.parseISODateTime(t),Q$Culture.dateTimeFormat.replace(":ss",""))}else return""};Q$Externals.logDateUserToString=function(t,e){var r="";if(t){r=Q.formatDate($.pi.parseISODateTime(t),Q$Culture.dateTimeFormat.replace(":ss",""))}if(e&&e.length){if(r.length)r+=" ";r+="("+e+")"}return r};Q$Externals.logDateUserToShortString=function(t,e){var r="";if(t){r=Q.formatDate(Q$Externals.parseISODateTime(t),Q$Culture.dateFormat.replace("yyyy","yy"))}if(e&&e.length){if(r.length)r+=" ";r+=e}return r};Q$Externals.parseInteger=function(t){t=Q.trim(t.toString());var e=Q$Culture.get_groupSeperator();if(t&&t.length&&t.indexOf(e)>0){t=t.replace(new RegExp("(\\b\\d{1,3})\\"+e+"(?=\\d{3}(\\D|$))","g"),"$1")}if(!/^[-\+]?\d+$/.test(t))return NaN;return parseInt(t,10)};Q$Externals.parseDate=function(t,e){if(!t||!t.length)return null;var r;var n;var a,i,l;n=Q$Externals.splitDateString(t);if(!n)return false;if(n.length==3){e=e||Q$Culture.dateOrder;switch(e){case"dmy":a=parseInt(n[0],10);i=parseInt(n[1],10)-1;l=parseInt(n[2],10);break;case"ymd":a=parseInt(n[2],10);i=parseInt(n[1],10)-1;l=parseInt(n[0],10);break;case"mdy":default:a=parseInt(n[1],10);i=parseInt(n[0],10)-1;l=parseInt(n[2],10);break}if(isNaN(a)||isNaN(i)||isNaN(l)||a<1||a>31||i<0||i>11||l>9999||l<0)return false;if(l<100){var o=(new Date).getFullYear();var s=o%100+10;l+=o-o%100+(l<=s?0:-100)}try{r=new Date(l,i,a);if(isNaN(r.getFullYear()))return false}catch(u){return false}}else if(n.length==1){try{r=new Date(n[0]);if(isNaN(r.getFullYear()))return false}catch(u){return false}}return r};Q$Externals.parseDecimal=function(t){t=Q.trim(t.toString());var e=Q$Culture.get_groupSeperator();if(t&&t.length&&t.indexOf(e)>0){t=t.replace(new RegExp("(\\b\\d{1,3})\\"+e+"(?=\\d{3}(\\D|$))","g"),"$1")}if(!new RegExp("^\\s*([-\\+])?(\\d*)\\"+Q$Culture.decimalSeparator+"?(\\d*)\\s*$").test(t))return NaN;return parseFloat(t.toString().replace(Q$Culture.decimalSeparator,"."))};Q$Externals.splitDateString=function(t){t=$.trim(t);if(!t.length)return;var e;if(t.indexOf("/")>=0)e=t.split("/");else if(t.indexOf(".")>=0)e=t.split(".");else if(t.indexOf("-")>=0)e=t.split("-");else if(t.indexOf("\\")>=0)e=t.split("\\");else e=[t];return e};Q$Externals.parseISODateTime=function(t){if(!t||!t.length)return null;var e=Date.parse(t);if(!isNaN(e)&&typeof e=="Date")return e;t=t+"";if(typeof t!="string"||t.length===0){return null}var r=t.match(Q$Externals.isoRegexp);if(typeof r=="undefined"||r===null){return null}var n,a,i,l,o,s,u;n=parseInt(r[1],10);if(typeof r[2]=="undefined"||r[2]===""){return new Date(n)}a=parseInt(r[2],10)-1;i=parseInt(r[3],10);if(typeof r[4]=="undefined"||r[4]===""){return new Date(n,a,i)}l=parseInt(r[4],10);o=parseInt(r[5],10);s=typeof r[6]!="undefined"&&r[6]!==""?parseInt(r[6],10):0;if(typeof r[7]!="undefined"&&r[7]!==""){u=Math.round(1e3*parseFloat("0."+r[7]))}else{u=0}if((typeof r[8]=="undefined"||r[8]==="")&&(typeof r[9]=="undefined"||r[9]==="")){return new Date(n,a,i,l,o,s,u)}var d;if(typeof r[9]!="undefined"&&r[9]!==""){d=parseInt(r[10],10)*36e5;if(typeof r[11]!="undefined"&&r[11]!==""){d+=parseInt(r[11],10)*6e4}if(r[9]=="-"){d=-d}}else{d=0}return new Date(Date.UTC(n,a,i,l,o,s,u)-d)};Q$Externals.parseHourAndMin=function(t){var e=Q.trim(t);if(e.length<4||e.length>5)return NaN;var r,n;if(e.charAt(1)==":"){r=$.pi.parseInteger(e.substr(0,1));n=$.pi.parseInteger(e.substr(2,2))}else{if(e.charAt(2)!=":")return NaN;r=$.pi.parseInteger(e.substr(0,2));n=$.pi.parseInteger(e.substr(3,2))}if(isNaN(r)||isNaN(n)||r<0||r>23||n<0||n>59)return NaN;return r*60+n};Q$Externals.parseDayHourAndMin=function(t){var e;var r=Q.trim(t);if(!r)return NaN;r=r.split(".");if(r.length==0||r.length>2)return NaN;if(r.length==1){e=$.pi.parseInteger(r[0]);if(!isNaN(e))return e*24*60;return $.pi.parseHourAndMin(r[0])}else{e=$.pi.parseInteger(r[0]);var n=$.pi.parseHourAndMin(r[1]);if(isNaN(e)||isNaN(n))return NaN;return e*24*60+n}};Q$Externals.parseQueryString=function(t){var e;if(arguments.length==0)e=location.search.substring(1,location.search.length);else e=t||"";var r={};var n=e.split("&");for(var a=0;a<n.length;a++){var i=n[a].split("=");var l=decodeURIComponent(i[0]);r[l]=i.length>=2?decodeURIComponent(i[1]):l}return r};Q$Externals.turkishLocaleCompare=function(t,e){var r="AaBbCcÇçFfGgĞğHhIıİiJjKkLlMmNnOoÖöPpRrSsŞşTtUuÜüVvYyZz";t=t||"";e=e||"";if(t==e)return 0;if(!Q$Externals.turkishLocaleIndex){Q$Externals.turkishLocaleIndex={};for(var n=0;n<r.length;n++){Q$Externals.turkishLocaleIndex[r.charAt(n)]=n+1}}for(var a=0,i=Math.min(t.length,e.length);a<i;a++){var l=t.charAt(a),o=e.charAt(a);if(l===o)continue;var s=Q$Externals.turkishLocaleIndex[l],u=Q$Externals.turkishLocaleIndex[o];if(s!=null&&u!=null)return s<u?-1:1;var d=l.localeCompare(o);if(d==0)continue;return d}return t.localeCompare(e)};Q$Externals.turkishLocaleToUpper=function(t){if(!t)return t;return t.replace(/i/g,"İ").replace(/ı/g,"I").toUpperCase()};Q$Externals.alertDialog=function(t,e){var r;e=$.extend({htmlEncode:true,okButton:Q.text("Dialogs.OkButton"),title:Q.text("Dialogs.AlertTitle"),onClose:null,onOpen:null,autoOpen:false,dialogClass:"s-MessageDialog s-AlertDialog",modal:true,width:"40%",maxWidth:"450",minWidth:"180",resizable:false,open:function(){if(e.onOpen)e.onOpen.call(this)},close:function(){r.dialog("destroy");if(e.onClose)e.onClose()}},e);if(e.htmlEncode)t=Q.htmlEncode(t);if(!e.buttons){var n=[];n.push({text:e.okButton,click:function(){r.dialog("close")}});e.buttons=n}r=$('<div><div class="message"></div></div>').dialog(e).children(".message").html(t).parent().dialog("open")};Q$Externals.confirmDialog=function(t,e,r){var n;r=$.extend({htmlEncode:true,yesButton:Q.text("Dialogs.YesButton"),noButton:Q.text("Dialogs.NoButton"),title:Q.text("Dialogs.ConfirmationTitle"),onNo:null,onCancel:null,onClose:null,autoOpen:false,modal:true,dialogClass:"s-MessageDialog s-ConfirmDialog",width:"40%",maxWidth:"450",minWidth:"180",resizable:false,open:function(){if(r.onOpen)r.onOpen.call(this)},close:function(){n.dialog("destroy");if(!a&&r.onCancel)r.onCancel()},overlay:{opacity:.7,background:"black"}},r);if(r.htmlEncode)t=Q.htmlEncode(t);var a=false;if(!r.buttons){var i=[];i.push({text:r.yesButton,click:function(){a=true;n.dialog("close");if(e)e()}});if(r.noButton)i.push({text:r.noButton,click:function(){a=true;n.dialog("close");if(r.onNo)r.onNo();else if(r.onCancel)r.onCancel()}});r.buttons=i}n=$('<div><div class="message"></div></div>').dialog(r).children(".message").html(t).parent().dialog("open")};Q$Externals.iframeDialog=function(t){var e;var r=$("<div><iframe></iframe></div>");var n=$.extend({autoOpen:true,modal:true,width:"60%",height:"400",title:Q.text("Dialogs.AlertTitle"),open:function(){e=r.find("iframe").css({border:"none",width:"100%",height:"100%"})[0].contentDocument;e.open();e.write(n.html);e.close()},close:function(){e.open();e.write("");e.close();r.dialog("destroy").html("")}},t);r.dialog(n)};Q$Externals.setupAjaxIndicator=function(){var t=null;var e=0;$(document).ajaxStart(function(){window.clearTimeout(e);e=window.setTimeout(function(){if(!t)t=$("<div/>").addClass("s-AjaxIndicator").appendTo(document.body)},2e3)}).ajaxStop(function(){if(t){t.remove();t=null}window.clearTimeout(e)})};Q$Externals.toId=function(t){if(t==null)return null;if(typeof t=="number")return t;t=$.trim(t);if(t==null||!t.length)return null;if(t.length>=15)return t;return parseInt(t,10)};Q$Externals.jQueryValidationInitialization=function(){Serenity.CustomValidation.registerValidationMethods();jQuery.validator.addMethod("xss",function(t,e){if(t.length==0)return true;var r=0;while(true){var n=t.indexOf("&",r);if(n<0)n=t.indexOf("<",r);if(n<0)return true;if(n==t.length-1)return true;var a=t.charAt(n);var i=t.charAt(n+1);if(a!="&"){if(a=="<"&&(i>="a"&&i<="z"||i>="A"&&i<="Z"||i=="!"||i=="/"))return false}else if(i=="#")return false;r=n+1}});$.validator.addMethod("dateQ",function(t,e){return this.optional(e)||Q$Externals.parseDate(t)!=false});$.validator.addMethod("hourAndMin",function(t,e){return this.optional(e)||!isNaN(Q.parseHourAndMin(t))});$.validator.addMethod("dayHourAndMin",function(t,e){return this.optional(e)||!isNaN(Q.parseDayHourAndMin(t))});$.validator.addMethod("decimalQ",function(t,e){return this.optional(e)||!isNaN(Q.parseDecimal(t))});$.validator.addMethod("integerQ",function(t,e){return this.optional(e)||!isNaN(Q.parseInteger(t))});var t=$.validator.methods.email;$.validator.addMethod("email",function(e,r){if(!Q$Config.emailAllowOnlyAscii)return t.call(this,e,r);return this.optional(r)||/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(e)});$.validator.addMethod("emailMultiple",function(t,e){var r=this.optional(e);if(r)return r;if(t.indexOf(";")>=0)t=t.split(";");else t=t.split(",");for(var n=0;n<t.length;n++){r=$.validator.methods.email.call(this,t[n],e);if(!r)return r}return r});$.validator.addMethod("anyvalue",function(t,e){return true});$.validator.defaults.ignoreTitle=true;$.validator.defaults.onchange=function(t){this.element(t)};$.validator.prototype.oldinit=$.validator.prototype.init;$.validator.prototype.init=function(){$.validator.prototype.oldinit.call(this);function t(t){if(this.form==null)return;var e=$.data(this.form,"validator"),r="on"+t.type.replace(/^validate/,"");e&&e.settings[r]&&e.settings[r].call(e,this)}function e(e){var r=this[0];if(!$.data(r,"changebound")){$(r).change(t);$.data(r,"changebound",true)}}$(this.currentForm).validateDelegate(":text, :password, :file, select, textarea","focusin",e)};$.validator.prototype.oldfocusInvalid=$.validator.prototype.focusInvalid;$.validator.prototype.focusInvalid=function(){if(this.settings.abortHandler)this.settings.abortHandler(this);this.oldfocusInvalid.call(this);if($.fn.qtip){var t=$("label.error",this.currentForm).not(".checked").eq(0);if(t.length){t.qtip("show")}}};$.validator.prototype.oldstopRequest=$.validator.prototype.focusInvalid;$.validator.prototype.stopRequest=function(t,e){var r=this.formSubmitted;this.oldfocusInvalid.call(this,[t,e]);if(!e&&this.pendingRequest==0&&r&&this.settings.abortHandler){this.settings.abortHandler(this)}};$.validator.prototype.resetAll=function(){this.submitted={};this.prepareForm();this.hideErrors();this.elements().removeClass(this.settings.errorClass)};jQuery(function(){$.extend($.validator.messages,{email:Q.text("Validation.Email"),required:Q.text("Validation.Required"),minlength:Q.text("Validation.MinLength"),maxlength:Q.text("Validation.MaxLength"),digits:Q.text("Validation.Digits"),range:Q.text("Validation.Range"),xss:Q.text("Validation.Xss"),dateQ:Q.text("Validation.DateInvalid"),decimalQ:Q.text("Validation.Decimal"),integerQ:Q.text("Validation.Integer"),url:Q.text("Validation.Url")})})};Q$Externals.validatorAbortHandler=function(t){t.settings.abortHandler=null;t.settings.submitHandler=function(){return false}};Q$Externals.validateAddTip=function(t){if($.fn.qtip){t.qtip({style:{classes:"ui-tooltip-red",widget:false}})}};Q$Externals.validateDelTip=function(t){if($.fn.qtip&&t.data("qtip")){t.qtip("destroy").attr("title","")}};Q$Externals.validateShowLabel=function(t,e){var r=this.errorsFor(t);if(r.length){r.removeClass().addClass(this.settings.errorClass);if(r.attr("generated"))r.attr("title",e);Q$Externals.validateAddTip(r)}else{r=$("<"+this.settings.errorElement+"/>").attr({"for":this.idOrName(t),generated:true}).addClass(this.settings.errorClass).attr("title",e||"");if(this.settings.wrapper){r=r.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()}if(!this.labelContainer.append(r).length)this.settings.errorPlacement?this.settings.errorPlacement(r,$(t)):r.insertAfter(t);Q$Externals.validateAddTip(r)}if(!e&&this.settings.success){typeof this.settings.success=="string"?r.addClass(this.settings.success):this.settings.success(r);r.attr("title","")}this.toShow=this.toShow.add(r)},Q$Externals.validateOptions=function(t){$.validator.prototype.showLabel=Q$Externals.validateShowLabel;return $.extend({ignore:":hidden",meta:"v",errorClass:"error",errorPlacement:function(t,e){var r=null;var n=e.attr("data-vx-id");if(n){r=$("#"+n);if(!r.length)r=null;else r=r[0]}if(r==null){r=e.parents("div.field");if(r.length){var a=$("div.vx",r[0]);if(a.length)r=a[0]}else r=e.parent()}t.appendTo(r)},submitHandler:function(){return false},invalidHandler:function(){Q.notifyError(Q.text("Validation.InvalidFormMessage"),"error")},success:function(t){t.addClass("checked");Q$Externals.validateDelTip(t)}},t)};if(window.jQuery&&window.jQuery.validator)Q$Externals.jQueryValidationInitialization();else if(window.jQuery){jQuery(function(t){if(t.validator)Q$Externals.jQueryValidationInitialization()})}Q$Externals.jQueryDatepickerInitialization=function(){var t=Q$Culture.dateOrder;var e=Q$Culture.dateSeparator;$.datepicker.setDefaults({firstDay:1,dateFormat:t=="mdy"?"mm"+e+"dd"+e+"yy":t=="ymd"?"yy"+e+"mm"+e+"dd":"dd"+e+"mm"+e+"yy",buttonImage:Q.resolveUrl("~/content/serenity/images/datepicker.gif"),buttonImageOnly:true,showOn:"both",showButtonPanel:true,changeMonth:true,changeYear:true})};if(window.jQuery&&window.jQuery.datepicker)Q$Externals.jQueryDatepickerInitialization();else jQuery(function(t){if(t.datepicker)Q$Externals.jQueryDatepickerInitialization()});Q$Externals.jQuerySelect2Initialization=function(){$.ui.dialog.prototype._allowInteraction=function(t){if($(t.target).closest(".ui-dialog").length){return true}return!!$(t.target).closest(".ui-datepicker, .select2-drop, .cke, .cke_dialog, #support-modal").length}};if(window.jQuery&&window.jQuery.ui)Q$Externals.jQuerySelect2Initialization();else jQuery(function(t){if(window.jQuery.ui)Q$Externals.jQuerySelect2Initialization()});Q$Externals.postToService=function(t){var e=$("<form/>").attr("method","POST").attr("action",t.url?Q.resolveUrl(t.url):Q.resolveUrl("~/services/"+t.service)).appendTo(document.body);if(t.target)e.attr("target",t.target);var r=$("<div/>").appendTo(e);$("<input/>").attr("type","hidden").attr("name","request").val($.toJSON(t.request)).appendTo(r);$("<input/>").attr("type","submit").appendTo(r);e.submit();window.setTimeout(function(){e.remove()},0)};Q$Externals.postToUrl=function(t){var e=$("<form/>").attr("method","POST").attr("action",Q.resolveUrl(t.url)).appendTo(document.body);if(t.target)e.attr("target",t.target);var r=$("<div/>").appendTo(e);if(t.params!=null){for(var n in t.params){$("<input/>").attr("type","hidden").attr("name",n).val(t.params[n]).appendTo(r)}}$("<input/>").attr("type","submit").appendTo(r);e.submit();window.setTimeout(function(){e.remove()},0)};Q$Externals.ssExceptionInitialization=function(){window.ss.Exception.prototype.toString=function(){return this.get_message()}};if(window.ss&&window.ss.Exception)Q$Externals.ssExceptionInitialization();else jQuery(function(t){if(window.ss&&window.ss.Exception)Q$Externals.ssExceptionInitialization()});global.Q$Externals=Q$Externals;function showInFrame(t){height=screen.availHeight-60;width=screen.availWidth-10;var e=(screen.availWidth-width)/2-5;if(e<0)e=0;var r=(screen.availHeight-height)/2-25;if(r<0)r=0;var n=window.open("","","status=0, toolbar=0, width="+width+", height="+height+", scrollbars=1, resizable=yes, left="+e+", top="+r);n.document.body.innerHTML=t}