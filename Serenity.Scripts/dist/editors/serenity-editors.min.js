var Serenity;(function(e){var t=function(t){__extends(i,t);function i(e){return t.call(this,e)||this}Object.defineProperty(i.prototype,"value",{get:function(){return this.element.val()},set:function(e){this.element.val(e)},enumerable:true,configurable:true});i.prototype.get_value=function(){return this.value};i.prototype.set_value=function(e){this.value=e};i=__decorate([e.Decorators.registerEditor("Serenity.StringEditor",[e.IStringValue]),e.Decorators.element('<input type="text"/>')],i);return i}(e.Widget);e.StringEditor=t})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(t){__extends(i,t);function i(e){var i=t.call(this,e)||this;e.attr("type","password");return i}i=__decorate([e.Decorators.registerEditor("Serenity.PasswordEditor")],i);return i}(e.StringEditor);e.PasswordEditor=t})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(t){__extends(i,t);function i(e,i){var r=t.call(this,e,i)||this;if(r.options.cols!==0){e.attr("cols",Q.coalesce(r.options.cols,80))}if(r.options.rows!==0){e.attr("rows",Q.coalesce(r.options.rows,6))}return r}Object.defineProperty(i.prototype,"value",{get:function(){return this.element.val()},set:function(e){this.element.val(e)},enumerable:true,configurable:true});i.prototype.get_value=function(){return this.value};i.prototype.set_value=function(e){this.value=e};i=__decorate([e.Decorators.registerEditor("Sereniy.TextAreaEditor",[e.IStringValue]),e.Decorators.element("<textarea />")],i);return i}(e.Widget);e.TextAreaEditor=t})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(t){__extends(i,t);function i(){return t!==null&&t.apply(this,arguments)||this}Object.defineProperty(i.prototype,"value",{get:function(){return this.element.is(":checked")},set:function(e){this.element.prop("checked",!!e)},enumerable:true,configurable:true});i.prototype.get_value=function(){return this.value};i.prototype.set_value=function(e){this.value=e};i=__decorate([e.Decorators.registerEditor("Serenity.BooleanEditor",[e.IBooleanValue]),e.Decorators.element('<input type="checkbox"/>')],i);return i}(e.Widget);e.BooleanEditor=t})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(t){__extends(i,t);function i(i,r){var n=t.call(this,i,r)||this;i.addClass("decimalQ");var a=Q.extend(e.DecimalEditor.defaultAutoNumericOptions(),{vMin:Q.coalesce(n.options.minValue,n.options.allowNegatives?n.options.maxValue!=null?"-"+n.options.maxValue:"-999999999999.99":"0.00"),vMax:Q.coalesce(n.options.maxValue,"999999999999.99")});if(n.options.decimals!=null){a.mDec=n.options.decimals}if(n.options.padDecimals!=null){a.aPad=n.options.padDecimals}if($.fn.autoNumeric)i.autoNumeric(a);return n}i.prototype.get_value=function(){if($.fn.autoNumeric){var e=this.element.autoNumeric("get");if(!!(e==null||e===""))return null;return parseFloat(e)}var e=this.element.val();return Q.parseDecimal(e)};Object.defineProperty(i.prototype,"value",{get:function(){return this.get_value()},set:function(e){this.set_value(e)},enumerable:true,configurable:true});i.prototype.set_value=function(e){if(e==null||e===""){this.element.val("")}else if($.fn.autoNumeric){this.element.autoNumeric("set",e)}else this.element.val(Q.formatNumber(e))};i.prototype.get_isValid=function(){return!isNaN(this.get_value())};i.defaultAutoNumericOptions=function(){return{aDec:Q.Culture.decimalSeparator,altDec:Q.Culture.decimalSeparator==="."?",":".",aSep:Q.Culture.decimalSeparator==="."?",":".",aPad:true}};i=__decorate([e.Decorators.registerEditor("Serenity.DecimalEditor",[e.IDoubleValue]),e.Decorators.element('<input type="text"/>')],i);return i}(e.Widget);e.DecimalEditor=t})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(t){__extends(i,t);function i(i,r){var n=t.call(this,i,r)||this;i.addClass("integerQ");var a=Q.extend(e.DecimalEditor.defaultAutoNumericOptions(),{vMin:Q.coalesce(n.options.minValue,n.options.allowNegatives?n.options.maxValue!=null?"-"+n.options.maxValue:"-2147483647":"0"),vMax:Q.coalesce(n.options.maxValue,2147483647),aSep:null});if($.fn.autoNumeric)i.autoNumeric(a);return n}i.prototype.get_value=function(){if($.fn.autoNumeric){var e=this.element.autoNumeric("get");if(!!Q.isTrimmedEmpty(e))return null;else return parseInt(e,10)}else{var e=Q.trimToNull(this.element.val());if(e==null)return null;return Q.parseInteger(e)}};Object.defineProperty(i.prototype,"value",{get:function(){return this.get_value()},set:function(e){this.set_value(e)},enumerable:true,configurable:true});i.prototype.set_value=function(e){if(e==null||e==="")this.element.val("");else if($.fn.autoNumeric)this.element.autoNumeric("set",e);else this.element.val(Q.formatNumber(e))};i.prototype.get_isValid=function(){return!isNaN(this.get_value())};i=__decorate([e.Decorators.registerEditor("Serenity.IntegerEditor",[e.IDoubleValue]),e.Decorators.element('<input type="text"/>')],i);return i}(e.Widget);e.IntegerEditor=t})(Serenity||(Serenity={}));var Serenity;(function(e){var t=e.Decorators.option;e.datePickerIconSvg='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 17 17"><g></g><path d="M14 2v-1h-3v1h-5v-1h-3v1h-3v15h17v-15h-3zM12 2h1v2h-1v-2zM4 2h1v2h-1v-2zM16 16h-15v-8.921h15v8.921zM1 6.079v-3.079h2v2h3v-2h5v2h3v-2h2v3.079h-15z" fill="#000000"></path></svg>';var i=function(i){__extends(r,i);function r(t){var r=i.call(this,t)||this;if(typeof flatpickr!=="undefined"&&(n.useFlatpickr||!$.fn.datepicker)){flatpickr(t[0],n.flatPickrOptions(t))}else if($.fn.datepicker){t.datepicker({showOn:"button",beforeShow:function(e,i){return!t.hasClass("readonly")},yearRange:Q.coalesce(r.yearRange,"-100:+50")})}else{t.attr("type","date")}t.on("keyup."+r.uniqueName,function(t){if(t.which===32&&!r.get_readOnly()){if(r.get_valueAsDate()!=Q.today()){r.set_valueAsDate(Q.today());r.element.trigger("change")}}else{e.DateEditor.dateInputKeyup(t)}});t.on("change."+r.uniqueName,e.DateEditor.dateInputChange);Q.addValidationRule(t,r.uniqueName,function(e){var t=r.get_value();if(Q.isEmptyOrNull(t)){return null}if(!Q.isEmptyOrNull(r.get_minValue())&&Q.Invariant.stringCompare(t,r.get_minValue())<0){return Q.format(Q.text("Validation.MinDate"),Q.formatDate(r.get_minValue(),null))}if(!Q.isEmptyOrNull(r.get_maxValue())&&Q.Invariant.stringCompare(t,r.get_maxValue())>=0){return Q.format(Q.text("Validation.MaxDate"),Q.formatDate(r.get_maxValue(),null))}return null});r.set_sqlMinMax(true);return r}n=r;r.flatPickrOptions=function(e){return{clickOpens:true,allowInput:true,dateFormat:Q.Culture.dateOrder.split("").join(Q.Culture.dateSeparator).replace("y","Y"),onChange:function(){e.triggerHandler("change")}}};r.prototype.get_value=function(){var e=this.element.val().trim();if(e!=null&&e.length===0){return null}return Q.formatDate(e,"yyyy-MM-dd")};Object.defineProperty(r.prototype,"value",{get:function(){return this.get_value()},set:function(e){this.set_value(e)},enumerable:true,configurable:true});r.prototype.set_value=function(e){if(e==null){this.element.val("")}else if(e.toLowerCase()==="today"||e.toLowerCase()==="now"){this.element.val(Q.formatDate(Q.today(),null))}else{this.element.val(Q.formatDate(e,null))}};r.prototype.get_valueAsDate=function(){if(Q.isEmptyOrNull(this.get_value())){return null}return Q.parseISODateTime(this.get_value())};Object.defineProperty(r.prototype,"valueAsDate",{get:function(){return this.get_valueAsDate()},set:function(e){this.set_valueAsDate(e)},enumerable:true,configurable:true});r.prototype.set_valueAsDate=function(e){if(e==null){this.set_value(null)}this.set_value(Q.formatDate(e,"yyyy-MM-dd"))};r.prototype.get_readOnly=function(){return this.element.hasClass("readonly")};r.prototype.set_readOnly=function(e){if(e!==this.get_readOnly()){if(e){this.element.addClass("readonly").attr("readonly","readonly");this.element.nextAll(".ui-datepicker-trigger").css("opacity","0.1")}else{this.element.removeClass("readonly").removeAttr("readonly");this.element.nextAll(".ui-datepicker-trigger").css("opacity","1")}}};r.prototype.get_minValue=function(){return this.minValue};r.prototype.set_minValue=function(e){this.minValue=e};r.prototype.get_maxValue=function(){return this.maxValue};r.prototype.set_maxValue=function(e){this.maxValue=e};r.prototype.get_minDate=function(){return Q.parseISODateTime(this.get_minValue())};r.prototype.set_minDate=function(e){this.set_minValue(Q.formatDate(e,"yyyy-MM-dd"))};r.prototype.get_maxDate=function(){return Q.parseISODateTime(this.get_maxValue())};r.prototype.set_maxDate=function(e){this.set_maxValue(Q.formatDate(e,"yyyy-MM-dd"))};r.prototype.get_sqlMinMax=function(){return this.get_minValue()==="1753-01-01"&&this.get_maxValue()==="9999-12-31"};r.prototype.set_sqlMinMax=function(e){if(e){this.set_minValue("1753-01-01");this.set_maxValue("9999-12-31")}else{this.set_minValue(null);this.set_maxValue(null)}};r.flatPickrTrigger=function(t){return $('<i class="ui-datepicker-trigger" href="javascript:;">'+e.datePickerIconSvg+"</i>").insertAfter(t).click(function(){if(!t.hasClass("readonly"))t[0]._flatpickr.open()})};r.dateInputKeyup=function(e){if(Q.Culture.dateOrder!=="dmy"){return}var t=$(e.target);if(!t.is(":input")||t.attr("type")=="date"){return}if(t.is("[readonly]")||t.is(":disabled")){return}var i=Q.coalesce(t.val(),"");if(!!(i.length===0||t[0].selectionEnd!==i.length)){return}if(i.indexOf(Q.Culture.dateSeparator+Q.Culture.dateSeparator)!==-1){t.val(Q.replaceAll(i,Q.Culture.dateSeparator+Q.Culture.dateSeparator,Q.Culture.dateSeparator));return}function r(e){return e>=48&&e<=57}if(e.which===47||e.which===111){if(i.length>=2&&i.charAt(i.length-1)===Q.Culture.dateSeparator&&i.charAt(i.length-2)===Q.Culture.dateSeparator){t.val(i.substr(0,i.length-1));return}if(i.charAt(i.length-1)!==Q.Culture.dateSeparator){return}switch(i.length){case 2:{if(r(i.charCodeAt(0))){i="0"+i;break}else{return}}case 4:{if(r(i.charCodeAt(0))&&r(i.charCodeAt(2))&&i.charAt(1)==Q.Culture.dateSeparator){i="0"+i.charAt(0)+Q.Culture.dateSeparator+"0"+i.charAt(2)+Q.Culture.dateSeparator;break}else{return}}case 5:{if(r(i.charCodeAt(0))&&r(i.charCodeAt(2))&&r(i.charCodeAt(3))&&i.charAt(1)===Q.Culture.dateSeparator){i="0"+i;break}else if(r(i.charCodeAt(0))&&r(i.charCodeAt(1))&&r(i.charCodeAt(3))&&i.charAt(2)===Q.Culture.dateSeparator){i=i.charAt(0)+i.charAt(1)+Q.Culture.dateSeparator+"0"+i.charAt(3)+Q.Culture.dateSeparator;break}else{break}}default:{return}}t.val(i)}if(i.length<6&&(e.which>=48&&e.which<=57||e.which>=96&&e.which<=105)&&r(i.charCodeAt(i.length-1))){switch(i.length){case 1:{if(i.charCodeAt(0)<=51){return}i="0"+i;break}case 2:{if(!r(i.charCodeAt(0))){return}break}case 3:{if(!r(i.charCodeAt(0))||i.charAt(1)!==Q.Culture.dateSeparator||i.charCodeAt(2)<=49){return}i="0"+i.charAt(0)+Q.Culture.dateSeparator+"0"+i.charAt(2);break}case 4:{if(i.charAt(1)==Q.Culture.dateSeparator){if(!r(i.charCodeAt(0))||!r(i.charCodeAt(2))){return}i="0"+i;break}else if(i.charAt(2)==Q.Culture.dateSeparator){if(!r(i.charCodeAt(0))||!r(i.charCodeAt(1))||i.charCodeAt(3)<=49){return}i=i.charAt(0)+i.charAt(1)+Q.Culture.dateSeparator+"0"+i.charAt(3);break}else{return}}case 5:{if(i.charAt(2)!==Q.Culture.dateSeparator||!r(i.charCodeAt(0))||!r(i.charCodeAt(1))||!r(i.charCodeAt(3))){return}break}default:{return}}t.val(i+Q.Culture.dateSeparator)}};var n;r.dateInputChange=function(e){if(Q.Culture.dateOrder!=="dmy"){return}var t=$(e.target);if(!t.is(":input")||t.attr("type")=="date"){return}var i=Q.coalesce(t.val(),"");var r={};if(i.length>=6&&/^[0-9]*$/g.test(i)){t.val(i.substr(0,2)+Q.Culture.dateSeparator+i.substr(2,2)+Q.Culture.dateSeparator+i.substr(4))}i=Q.coalesce(t.val(),"");if(!!(i.length>=5&&Q.parseDate(i)!==false)){var n=Q.parseDate(i);t.val(Q.formatDate(n,null))}};__decorate([t()],r.prototype,"yearRange",void 0);__decorate([t()],r.prototype,"get_minValue",null);__decorate([t()],r.prototype,"get_maxValue",null);__decorate([t()],r.prototype,"get_maxDate",null);__decorate([t()],r.prototype,"get_sqlMinMax",null);r=n=__decorate([e.Decorators.registerEditor("Serenity.DateEditor",[e.IStringValue,e.IReadOnly]),e.Decorators.element('<input type="text"/>')],r);return r}(e.Widget);e.DateEditor=i;function r(){if(!$.datepicker||!$.datepicker.regional||!$.datepicker.regional.en)return false;var t=Q.Culture.dateOrder;var i=Q.Culture.dateSeparator;var r=($("html").attr("lang")||"en").toLowerCase();if(!$.datepicker.regional[r]){r=r.split("-")[0];if(!$.datepicker.regional[r]){r="en"}}$.datepicker.setDefaults($.datepicker.regional["en"]);$.datepicker.setDefaults($.datepicker.regional[r]);$.datepicker.setDefaults({dateFormat:t=="mdy"?"mm"+i+"dd"+i+"yy":t=="ymd"?"yy"+i+"mm"+i+"dd":"dd"+i+"mm"+i+"yy",buttonImage:"data:image/svg+xml,"+encodeURI(e.datePickerIconSvg),buttonImageOnly:true,showOn:"both",showButtonPanel:true,changeMonth:true,changeYear:true});return true}typeof $!=="undefined"&&!r()&&$(r)})(Serenity||(Serenity={}));var Serenity;(function(e){var t=e.Decorators.option;var i=function(i){__extends(r,i);function r(t,r){var a=i.call(this,t,r)||this;t.addClass("s-DateTimeEditor");if(a.options.inputOnly){t.addClass("dateTimeQ")}else if(typeof flatpickr!=="undefined"&&(e.DateEditor.useFlatpickr||!$.fn.datepicker||a.options.seconds)){t.addClass("dateTimeQ");flatpickr(t[0],a.getFlatpickrOptions())}else if($.fn.datepicker){t.addClass("dateQ");t.datepicker({showOn:"button",beforeShow:function(){return!t.hasClass("readonly")},yearRange:Q.coalesce(a.options.yearRange,"-100:+50")});t.bind("change."+a.uniqueName,function(t){a.lastSetValue=null;e.DateEditor.dateInputChange(t)});a.time=$("<select/>").addClass("editor s-DateTimeEditor time");var o=t.next(".ui-datepicker-trigger");if(o.length>0){a.time.insertAfter(o)}else{o=t.prev(".ui-datepicker-trigger");if(o.length>0){a.time.insertBefore(o)}else{a.time.insertAfter(t)}}a.time.on("change",function(e){this.lastSetValue=null;t.triggerHandler("change")});var l=n.getTimeOptions(Q.coalesce(a.options.startHour,0),0,Q.coalesce(a.options.endHour,23),59,Q.coalesce(a.options.intervalMinutes,5));for(var s=0,u=l;s<u.length;s++){var c=u[s];Q.addOption(a.time,c,c)}Q.addValidationRule(t,a.uniqueName,function(e){var t=a.get_value();if(Q.isEmptyOrNull(t)){return null}if(!Q.isEmptyOrNull(a.get_minValue())&&Q.Invariant.stringCompare(t,a.get_minValue())<0){return Q.format(Q.text("Validation.MinDate"),Q.formatDate(a.get_minValue(),null))}if(!Q.isEmptyOrNull(a.get_maxValue())&&Q.Invariant.stringCompare(t,a.get_maxValue())>=0){return Q.format(Q.text("Validation.MaxDate"),Q.formatDate(a.get_maxValue(),null))}return null})}else t.attr("type","datetime").addClass("dateTimeQ");t.bind("keyup."+a.uniqueName,function(t){if(a.get_readOnly())return;if(a.time){if(t.which===32){if(a.get_valueAsDate()!==new Date){a.set_valueAsDate(new Date);a.element.trigger("change")}}else{var i=a.element.val();e.DateEditor.dateInputKeyup(t);if(i!=a.element.val())a.lastSetValue=null}}});a.set_sqlMinMax(true);if(!a.options.inputOnly){$("<i class='inplace-button inplace-now'><b></b></div>").attr("title","set to now").insertAfter(a.time).click(function(e){if(a.element.hasClass("readonly")){return}a.lastSetValue=null;a.set_valueAsDate(new Date);t.triggerHandler("change")})}return a}n=r;r.prototype.getFlatpickrOptions=function(){var e=this;var t;return{clickOpens:true,allowInput:true,enableTime:true,time_24hr:true,enableSeconds:!!this.options.seconds,minuteIncrement:(t=this.options.intervalMinutes)!==null&&t!==void 0?t:5,dateFormat:Q.Culture.dateOrder.split("").join(Q.Culture.dateSeparator).replace("y","Y")+" H:i"+(this.options.seconds?":S":""),onChange:function(){e.lastSetValue=null;e.element&&e.element.triggerHandler("change")}}};r.prototype.get_value=function(){var e=this.element.val().trim();if(e!=null&&e.length===0){return null}var t;if(this.time){var i=Q.formatDate(e,"yyyy-MM-dd");var r=this.time.val();t=i+"T"+r+":00.000"}else t=Q.formatDate(Q.parseDate(this.element.val()),"yyyy-MM-ddTHH:mm:ss.fff");if(this.options.useUtc)t=Q.formatISODateTimeUTC(Q.parseISODateTime(t));if(this.lastSetValue!=null&&this.lastSetValueGet==t)return this.lastSetValue;return t};Object.defineProperty(r.prototype,"value",{get:function(){return this.get_value()},set:function(e){this.set_value(e)},enumerable:true,configurable:true});r.prototype.set_value=function(t){if(Q.isEmptyOrNull(t)){this.element.val("");this.time&&this.time.val("00:00")}else if(t.toLowerCase()==="today"){if(this.time){this.element.val(Q.formatDate(Q.today(),null));this.time.val("00:00")}else{this.element.val(this.getDisplayFormat())}}else{var i=t.toLowerCase()==="now"?new Date:Q.parseISODateTime(t);if(this.time){i=e.DateTimeEditor.roundToMinutes(i,Q.coalesce(this.options.intervalMinutes,5));this.element.val(Q.formatDate(i,null));this.time.val(Q.formatDate(i,"HH:mm"))}else this.element.val(Q.formatDate(i,this.getDisplayFormat()))}this.lastSetValue=null;if(!Q.isEmptyOrNull(t)){this.lastSetValueGet=this.get_value();this.lastSetValue=t}};r.prototype.getDisplayFormat=function(){return this.options.seconds?Q.Culture.dateTimeFormat:Q.Culture.dateTimeFormat.replace(":ss","")};r.prototype.get_valueAsDate=function(){if(Q.isEmptyOrNull(this.get_value())){return null}return Q.parseISODateTime(this.get_value())};Object.defineProperty(r.prototype,"valueAsDate",{get:function(){return this.get_valueAsDate()},set:function(e){this.set_valueAsDate(e)},enumerable:true,configurable:true});r.prototype.set_valueAsDate=function(e){if(e==null){this.set_value(null)}this.set_value(Q.formatDate(e,"yyyy-MM-ddTHH:mm"+(this.options.seconds?":ss":"")))};r.prototype.get_minValue=function(){return this.minValue};r.prototype.set_minValue=function(e){this.minValue=e};r.prototype.get_maxValue=function(){return this.maxValue};r.prototype.set_maxValue=function(e){this.maxValue=e};r.prototype.get_minDate=function(){return Q.parseISODateTime(this.get_minValue())};r.prototype.set_minDate=function(e){this.set_minValue(Q.formatDate(e,"yyyy-MM-ddTHH:mm:ss"))};r.prototype.get_maxDate=function(){return Q.parseISODateTime(this.get_maxValue())};r.prototype.set_maxDate=function(e){this.set_maxValue(Q.formatDate(e,"yyyy-MM-ddTHH:mm:ss"))};r.prototype.get_sqlMinMax=function(){return this.get_minValue()==="1753-01-01"&&this.get_maxValue()==="9999-12-31"};r.prototype.set_sqlMinMax=function(e){if(e){this.set_minValue("1753-01-01");this.set_maxValue("9999-12-31")}else{this.set_minValue(null);this.set_maxValue(null)}};r.prototype.get_readOnly=function(){return this.element.hasClass("readonly")};r.prototype.set_readOnly=function(e){if(e!==this.get_readOnly()){if(e){this.element.addClass("readonly").attr("readonly","readonly");this.element.nextAll(".ui-datepicker-trigger").css("opacity","0.1");this.element.nextAll(".inplace-now").css("opacity","0.1")}else{this.element.removeClass("readonly").removeAttr("readonly");this.element.nextAll(".ui-datepicker-trigger").css("opacity","1");this.element.nextAll(".inplace-now").css("opacity","1")}this.time&&this.time.attr("readonly",e?"readonly":null)}};r.roundToMinutes=function(e,t){e=new Date(e.getTime());var i=Q.trunc(Q.round(e.getMinutes()/t)*t);e.setMinutes(i);e.setSeconds(0);e.setMilliseconds(0);return e};var n;r.getTimeOptions=function(e,t,i,r,n){var a=[];if(i>=23){i=23}if(r>=60){r=59}var o=e;var l=t;while(true){if(o>i||o===i&&l>r){break}var s=(o>=10?"":"0")+o+":"+(l>=10?"":"0")+l;a.push(s);l+=n;if(l>=60){l-=60;o++}}return a};__decorate([t()],r.prototype,"get_minValue",null);__decorate([t()],r.prototype,"get_maxValue",null);__decorate([t()],r.prototype,"get_maxDate",null);__decorate([t()],r.prototype,"get_sqlMinMax",null);r=n=__decorate([e.Decorators.registerEditor("Serenity.DateTimeEditor",[e.IStringValue,e.IReadOnly]),e.Decorators.element('<input type="text"/>')],r);return r}(e.Widget);e.DateTimeEditor=i})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(t){__extends(i,t);function i(e,i){var r=t.call(this,e,i)||this;e.addClass("editor s-TimeEditor hour");if(!r.options.noEmptyOption){Q.addOption(e,"","--")}for(var n=r.options.startHour||0;n<=(r.options.endHour||23);n++){Q.addOption(e,n.toString(),n<10?"0"+n:n.toString())}r.minutes=$("<select/>").addClass("editor s-TimeEditor minute").insertAfter(e);r.minutes.change(function(){return r.element.trigger("change")});for(var a=0;a<=59;a+=r.options.intervalMinutes||5){Q.addOption(r.minutes,a.toString(),a<10?"0"+a:a.toString())}return r}Object.defineProperty(i.prototype,"value",{get:function(){var e=Q.toId(this.element.val());var t=Q.toId(this.minutes.val());if(e==null||t==null){return null}return e*60+t},set:function(e){if(!e){if(this.options.noEmptyOption){this.element.val(this.options.startHour);this.minutes.val("0")}else{this.element.val("");this.minutes.val("0")}}else{this.element.val(Math.floor(e/60).toString());this.minutes.val(e%60)}},enumerable:true,configurable:true});i.prototype.get_value=function(){return this.value};i.prototype.set_value=function(e){this.value=e};i.prototype.get_readOnly=function(){return this.element.hasClass("readonly")};i.prototype.set_readOnly=function(t){if(t!==this.get_readOnly()){if(t){this.element.addClass("readonly").attr("readonly","readonly")}else{this.element.removeClass("readonly").removeAttr("readonly")}e.EditorUtils.setReadonly(this.minutes,t)}};i=__decorate([e.Decorators.registerEditor("Serenity.TimeEditor",[e.IDoubleValue,e.IReadOnly]),e.Decorators.element("<select />")],i);return i}(e.Widget);e.TimeEditor=t})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(t){__extends(i,t);function i(e){var i=t.call(this,e)||this;e.attr("type","email").addClass("email");return i}i=__decorate([e.Decorators.registerEditor("Serenity.EmailAddressEditor")],i);return i}(e.StringEditor);e.EmailAddressEditor=t})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(t){__extends(i,t);function i(e,i){var n=t.call(this,e,i)||this;r.registerValidationMethods();e.addClass("emailuser");var a=$("<span/>").text("@").addClass("emailat").insertAfter(e);var o=$('<input type="text"/>').addClass("emaildomain").insertAfter(a);o.bind("blur."+n.uniqueName,function(){var t=o.closest("form").data("validator");if(t!=null){t.element(e[0])}});if(!Q.isEmptyOrNull(n.options.domain)){o.val(n.options.domain)}if(n.options.readOnlyDomain){o.attr("readonly","readonly").addClass("disabled").attr("tabindex","-1")}e.bind("keypress."+n.uniqueName,function(e){if(e.which===64){e.preventDefault();if(!n.options.readOnlyDomain){o.focus();o.select()}}});o.bind("keypress."+n.uniqueName,function(e){if(e.which===64){e.preventDefault()}});if(!n.options.readOnlyDomain){e.change(function(t){return n.set_value(e.val())})}return n}r=i;i.registerValidationMethods=function(){var e;if(!$.validator||!$.validator.methods||$.validator.methods["emailuser"]!=null)return;$.validator.addMethod("emailuser",function(e,t){var i=$(t).nextAll(".emaildomain");if(i.length>0&&i.attr("readonly")==null){if(this.optional(t)&&this.optional(i[0])){return true}return $.validator.methods.email.call(e+"@"+i.val())}},(e=Q.tryGetText("Validation.Email"))!==null&&e!==void 0?e:$.validator.messages.email)};i.prototype.get_value=function(){var e=this.element.nextAll(".emaildomain");var t=this.element.val();var i=e.val();if(Q.isEmptyOrNull(t)){if(this.options.readOnlyDomain||Q.isEmptyOrNull(i)){return""}return"@"+i}return t+"@"+i};Object.defineProperty(i.prototype,"value",{get:function(){return this.get_value()},set:function(e){this.set_value(e)},enumerable:true,configurable:true});i.prototype.set_value=function(e){var t=this.element.nextAll(".emaildomain");e=Q.trimToNull(e);if(e==null){if(!this.options.readOnlyDomain)t.val("");this.element.val("")}else{var i=e.split("@");if(i.length>1){if(!this.options.readOnlyDomain){t.val(i[1]);this.element.val(i[0])}else if(!Q.isEmptyOrNull(this.options.domain)){if(i[1]!==this.options.domain)this.element.val(e);else this.element.val(i[0])}else this.element.val(i[0])}else this.element.val(i[0])}};i.prototype.get_readOnly=function(){var e=this.element.nextAll(".emaildomain");return!(this.element.attr("readonly")==null&&(!this.options.readOnlyDomain||e.attr("readonly")==null))};i.prototype.set_readOnly=function(e){var t=this.element.nextAll(".emaildomain");if(e){this.element.attr("readonly","readonly").addClass("readonly");if(!this.options.readOnlyDomain){t.attr("readonly","readonly").addClass("readonly")}}else{this.element.removeAttr("readonly").removeClass("readonly");if(!this.options.readOnlyDomain){t.removeAttr("readonly").removeClass("readonly")}}};var r;i=r=__decorate([e.Decorators.registerEditor("Serenity.EmailEditor",[e.IStringValue,e.IReadOnly]),e.Decorators.element('<input type="text"/>')],i);return i}(e.Widget);e.EmailEditor=t})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(t){__extends(i,t);function i(e){var i=t.call(this,e)||this;e.addClass("url").attr("title","URL should be entered in format: 'http://www.site.com/page'.");e.on("blur."+i.uniqueName,function(t){var i=e.closest("form").data("validator");if(i==null)return;if(!e.hasClass("error"))return;var r=Q.trimToNull(e.val());if(!r)return;r="http://"+r;if($.validator.methods["url"].call(i,r,e[0])==true){e.val(r);i.element(e)}});return i}i=__decorate([e.Decorators.registerEditor("Serenity.URLEditor",[e.IStringValue])],i);return i}(e.StringEditor);e.URLEditor=t})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(t){__extends(i,t);function i(i,r){var n=t.call(this,i,r)||this;if(Q.isEmptyOrNull(n.options.enumKey)&&n.options.enumType==null&&Q.isEmptyOrNull(n.options.lookupKey)){return n}if(!Q.isEmptyOrNull(n.options.lookupKey)){var a=Q.getLookup(n.options.lookupKey);for(var o=0,l=a.items;o<l.length;o++){var s=l[o];var u=s[a.textField];var c=u==null?"":u.toString();var d=s[a.idField];var p=d==null?"":d.toString();n.addRadio(p,c)}}else{var f=n.options.enumType||e.EnumTypeRegistry.get(n.options.enumKey);var h=n.options.enumKey;if(h==null&&f!=null){var m=Q.getAttributes(f,e.EnumKeyAttribute,false);if(m.length>0){h=m[0].value}}var y=Q.Enum.getValues(f);for(var g=0,v=y;g<v.length;g++){var _=v[g];var S=Q.Enum.toString(f,_);n.addRadio(_.toString(),Q.coalesce(Q.tryGetText("Enums."+h+"."+S),S))}}return n}i.prototype.addRadio=function(e,t){var i=$("<label/>").text(t);$('<input type="radio"/>').attr("name",this.uniqueName).attr("id",this.uniqueName+"_"+e).attr("value",e).prependTo(i);i.appendTo(this.element)};i.prototype.get_value=function(){return this.element.find("input:checked").first().val()};Object.defineProperty(i.prototype,"value",{get:function(){return this.get_value()},set:function(e){this.set_value(e)},enumerable:true,configurable:true});i.prototype.set_value=function(e){if(e!==this.get_value()){var t=this.element.find("input");var i=t.filter(":checked");if(i.length>0){i[0].checked=false}if(!Q.isEmptyOrNull(e)){i=t.filter("[value="+e+"]");if(i.length>0){i[0].checked=true}}}};i.prototype.get_readOnly=function(){return this.element.attr("disabled")!=null};i.prototype.set_readOnly=function(e){if(this.get_readOnly()!==e){if(e){this.element.attr("disabled","disabled").find("input").attr("disabled","disabled")}else{this.element.removeAttr("disabled").find("input").removeAttr("disabled")}}};i=__decorate([e.Decorators.registerEditor("Serenity.RadioButtonEditor",[e.IStringValue,e.IReadOnly]),e.Decorators.element("<div/>")],i);return i}(e.Widget);e.RadioButtonEditor=t})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(t){__extends(i,t);function i(e,i){var r=t.call(this,e,i)||this;r._items=[];r._itemById={};var n=r.emptyItemText();if(n!=null){e.attr("placeholder",n)}var a=r.getSelect2Options();e.select2(a);e.attr("type","text");e.on("change."+r.uniqueName,function(t){if(!$(t.target).hasClass("select2-change-triggered")&&e.closest("form").data("validator")){e.valid()}});r.setCascadeFrom(r.options.cascadeFrom);if(r.useInplaceAdd())r.addInplaceCreate(Q.text("Controls.SelectEditor.InplaceAdd"),null);return r}r=i;i.prototype.destroy=function(){if(this.element!=null){this.element.select2("destroy")}t.prototype.destroy.call(this)};i.prototype.hasAsyncSource=function(){return false};i.prototype.asyncSearch=function(e,t){t({items:[],more:false});return null};i.prototype.getTypeDelay=function(){return Q.coalesce(this.options["typeDelay"],500)};i.prototype.emptyItemText=function(){return Q.coalesce(this.element.attr("placeholder"),Q.text("Controls.SelectEditor.EmptyItemText"))};i.prototype.getPageSize=function(){var e;return(e=this.options["pageSize"])!==null&&e!==void 0?e:100};i.prototype.getIdField=function(){return this.options["idField"]};i.prototype.itemId=function(e){var t=e[this.getIdField()];if(t==null)return"";return t.toString()};i.prototype.getTextField=function(){var e;return(e=this.options["textField"])!==null&&e!==void 0?e:this.getIdField()};i.prototype.itemText=function(e){var t=e[this.getTextField()];if(t==null)return"";return t.toString()};i.prototype.itemDisabled=function(e){return false};i.prototype.mapItem=function(e){return{id:this.itemId(e),text:this.itemText(e),disabled:this.itemDisabled(e),source:e}};i.prototype.mapItems=function(e){return e.map(this.mapItem.bind(this))};i.prototype.allowClear=function(){return this.options.allowClear!=null?!!this.options.allowClear:this.emptyItemText()!=null};i.prototype.isMultiple=function(){return!!this.options.multiple};i.prototype.getSelect2Options=function(){var e=this;var t=this.emptyItemText();var i={multiple:this.isMultiple(),placeHolder:!Q.isEmptyOrNull(t)?t:null,allowClear:this.allowClear(),createSearchChoicePosition:"bottom"};if(this.hasAsyncSource()){var n=0;var a=null;i.query=function(t){var i=e.getPageSize();var r={searchTerm:Q.trimToNull(t.term),skip:(t.page-1)*i,take:i,checkMore:true};a&&a.abort&&a.abort();a=null;if(n!=null)clearTimeout(n);var o=$(e.element).data("select2");o&&o.search&&o.search.removeClass("select2-active");n=setTimeout(function(){a&&a.abort&&a.abort();o&&o.search.addClass("select2-active");a=e.asyncSearch(r,function(i){a=null;t.callback({results:e.mapItems(i.items),more:i.more})});(a&&(a.catch||a.fail)).call(a,function(){a=null;o&&o.search&&o.search.removeClass("select2-active")})},!t.term?0:e.getTypeDelay())};var o=null;i.initSelection=function(t,i){var r=t.val();if(r==null||r==""){i(null);return}var n=e.isMultiple();var a=n?r.split(","):[r];var l={idList:a};o&&o.abort&&o.abort();o=e.asyncSearch(l,function(t){o=null;if(n){var l=(t.items||[]).map(function(t){return e.mapItem(t)});e._itemById=e._itemById||{};for(var s=0,u=l;s<u.length;s++){var c=u[s];e._itemById[c.id]=c}if(e.isAutoComplete&&l.length!=a.length){for(var d=0,p=a;d<p.length;d++){var f=p[d];if(!Q.any(l,function(e){return e.id==f})){l.push({id:f,text:f})}}}i(l)}else if(!t.items||!t.items.length){if(e.isAutoComplete){i({id:r,text:r})}else i(null)}else{var c=e.mapItem(t.items[0]);e._itemById=e._itemById||{};e._itemById[c.id]=c;i(c)}});(o&&(o.catch||o.fail)).call(o,function(){o=null})}}else{i.data=this._items;i.query=function(t){var i=r.filterByText(e._items,function(e){return e.text},t.term);var n=e.getPageSize();t.callback({results:i.slice((t.page-1)*n,t.page*n),more:i.length>=t.page*n})};i.initSelection=function(t,i){var r=t.val();var n=e.isAutoComplete();if(e.isMultiple()){var a=[];for(var o=0,l=r.split(",");o<l.length;o++){var s=l[o];var u=e._itemById[s];if(u==null&&n){u={id:s,text:s};e.addItem(u)}if(u!=null){a.push(u)}}i(a);return}var c=e._itemById[r];if(c==null&&n){c={id:r,text:r};e.addItem(c)}i(c)}}if(this.options.minimumResultsForSearch!=null)i.minimumResultsForSearch=this.options.minimumResultsForSearch;if(this.isAutoComplete()||this.useInplaceAdd())i.createSearchChoice=this.getCreateSearchChoice(null);return i};i.prototype.get_delimited=function(){return!!this.options.delimited};Object.defineProperty(i.prototype,"items",{get:function(){if(this.hasAsyncSource())throw new Error("Can't read items property of an async select editor!");return this._items||[]},set:function(e){if(this.hasAsyncSource())throw new Error("Can't set items of an async select editor!");this._items=e||[];this._itemById={};for(var t=0,i=this._items;t<i.length;t++){var r=i[t];this._itemById[r.id]=r
}},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"itemById",{get:function(){if(this.hasAsyncSource())throw new Error("Can't read items property of an async select editor!");return this._itemById},set:function(e){if(this.hasAsyncSource())throw new Error("Can't set itemById of an async select editor!");this._itemById=e||{}},enumerable:true,configurable:true});i.prototype.clearItems=function(){if(this.hasAsyncSource())throw new Error("Can't clear items of an async select editor!");this._items.length=0;this._itemById={}};i.prototype.addItem=function(e){if(this.hasAsyncSource())throw new Error("Can't add item to an async select editor!");this._items.push(e);this._itemById[e.id]=e};i.prototype.addOption=function(e,t,i,r){this.addItem({id:e,text:t,source:i,disabled:r})};i.prototype.addInplaceCreate=function(e,t){var i=this;var r=this;e=Q.coalesce(e,Q.text("Controls.SelectEditor.InplaceAdd"));t=Q.coalesce(t,Q.text("Controls.SelectEditor.InplaceEdit"));var n=$("<a><b/></a>").addClass("inplace-button inplace-create").attr("title",e).insertAfter(this.element).click(function(e){r.inplaceCreateClick(e)});this.get_select2Container().add(this.element).addClass("has-inplace-button");this.element.change(function(){var r=i.isMultiple()||Q.isEmptyOrNull(i.get_value());n.attr("title",r?e:t).toggleClass("edit",!r)});this.element.change(function(e){if($(e.target).hasClass("select2-change-triggered"))return;if(i.isMultiple()){var t=i.get_values();if(t.length>0&&t[t.length-1]==(-2147483648).toString()){i.set_values(t.slice(0,t.length-1));i.inplaceCreateClick(e)}}else if(i.get_value()==(-2147483648).toString()){i.set_value(null);i.inplaceCreateClick(e)}});if(this.isMultiple()){this.get_select2Container().on("dblclick."+this.uniqueName,".select2-search-choice",function(e){var t=$(e.target);if(!t.hasClass("select2-search-choice")){t=t.closest(".select2-search-choice")}var r=t.index();var n=i.get_values();if(r<0||r>=i.get_values().length){return}e["editItem"]=n[r];i.inplaceCreateClick(e)})}};i.prototype.useInplaceAdd=function(){return!this.isAutoComplete()&&this.options.inplaceAdd&&(this.options.inplaceAddPermission==null||Q.Authorization.hasPermission(this.options.inplaceAddPermission))};i.prototype.isAutoComplete=function(){return!!this.options.autoComplete};i.prototype.getCreateSearchChoice=function(e){var t=this;return function(i){t.lastCreateTerm=i;i=Q.coalesce(Select2.util.stripDiacritics(i),"").toLowerCase();if(Q.isTrimmedEmpty(i)){return null}var r=false;if(Q.any(t._items||[],function(t){var r=e?e(t.source):t.text;return Select2.util.stripDiacritics(Q.coalesce(r,"")).toLowerCase()==i}))return null;if(!Q.any(t._items||[],function(e){return Q.coalesce(Select2.util.stripDiacritics(e.text),"").toLowerCase().indexOf(i)!==-1})){if(t.isAutoComplete()){return{id:t.lastCreateTerm,text:t.lastCreateTerm}}return{id:(-2147483648).toString(),text:Q.text("Controls.SelectEditor.NoResultsClickToDefine")}}if(t.isAutoComplete()){return{id:t.lastCreateTerm,text:t.lastCreateTerm}}return{id:(-2147483648).toString(),text:Q.text("Controls.SelectEditor.ClickToDefine")}}};i.prototype.setEditValue=function(e,t){var i=e[t.name];if(Q.isArray(i)){this.set_values(i)}else{this.set_value(i==null?null:i.toString())}};i.prototype.getEditValue=function(e,t){if(!this.isMultiple()||this.get_delimited()){t[e.name]=this.get_value()}else{t[e.name]=this.get_values()}};i.prototype.get_select2Container=function(){return this.element.prevAll(".select2-container")};i.prototype.get_items=function(){return this.items};i.prototype.get_itemByKey=function(){return this.itemById};i.filterByText=function(e,t,i){if(i==null||i.length==0)return e;i=Select2.util.stripDiacritics(i).toUpperCase();var r=[];function n(e){var n=t(e);if(n==null||!n.length)return false;n=Select2.util.stripDiacritics(n).toUpperCase();if(Q.startsWith(n,i))return true;if(n.indexOf(i)>=0)r.push(e);return false}return e.filter(n).concat(r)};i.prototype.get_value=function(){var e;if(this.element.data("select2")){e=this.element.select2("val");if(e!=null&&Q.isArray(e)){return e.join(",")}}else e=this.element.val();return e};Object.defineProperty(i.prototype,"value",{get:function(){return this.get_value()},set:function(e){this.set_value(e)},enumerable:true,configurable:true});i.prototype.set_value=function(e){if(e!=this.get_value()){var t=e;if(!Q.isEmptyOrNull(e)&&this.isMultiple()){t=e.split(String.fromCharCode(44)).map(function(e){return Q.trimToNull(e)}).filter(function(e){return e!=null})}var i=this.element;i.select2("val",t);i.data("select2-change-triggered",true);try{i.triggerHandler("change")}finally{i.data("select2-change-triggered",false)}this.updateInplaceReadOnly()}};Object.defineProperty(i.prototype,"selectedItem",{get:function(){var e=this.get_value();if(e&&this._itemById){var t=this._itemById[e];if(t)return t.source}return null},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"selectedItems",{get:function(){var e=this.values;var t=[];for(var i=0,r=e;i<r.length;i++){var n=r[i];if(n&&this._itemById){var a=this._itemById[n];if(a&&a.source)t.push(a.source);else t.push(null)}}return t},enumerable:true,configurable:true});i.prototype.get_values=function(){var e=this.element.select2("val");if(e==null){return[]}if(Q.isArray(e)){return e}var t=e;if(Q.isEmptyOrNull(t)){return[]}return[t]};Object.defineProperty(i.prototype,"values",{get:function(){return this.get_values()},set:function(e){this.set_values(e)},enumerable:true,configurable:true});i.prototype.set_values=function(e){if(e==null||e.length===0){this.set_value(null);return}this.set_value(e.join(","))};i.prototype.get_text=function(){return Q.coalesce(this.element.select2("data"),{}).text};Object.defineProperty(i.prototype,"text",{get:function(){return this.get_text()},enumerable:true,configurable:true});i.prototype.get_readOnly=function(){return!Q.isEmptyOrNull(this.element.attr("readonly"))};Object.defineProperty(i.prototype,"readOnly",{get:function(){return this.get_readOnly()},set:function(e){this.set_readOnly(e)},enumerable:true,configurable:true});i.prototype.updateInplaceReadOnly=function(){var e=this.get_readOnly()&&(this.isMultiple()||!this.value);this.element.nextAll(".inplace-create").attr("disabled",e?"disabled":"").css("opacity",e?"0.1":"").css("cursor",e?"default":"")};i.prototype.set_readOnly=function(e){if(e!==this.get_readOnly()){this.element.attr("readonly",e?"readonly":null);this.updateInplaceReadOnly()}};i.prototype.getCascadeFromValue=function(t){return e.EditorUtils.getValue(t)};i.prototype.setCascadeFrom=function(t){var i=this;if(Q.isEmptyOrNull(t)){if(this.cascadeLink!=null){this.cascadeLink.set_parentID(null);this.cascadeLink=null}this.options.cascadeFrom=null;return}this.cascadeLink=new e.CascadedWidgetLink(e.Widget,this,function(e){i.set_cascadeValue(i.getCascadeFromValue(e))});this.cascadeLink.set_parentID(t);this.options.cascadeFrom=t};i.prototype.get_cascadeFrom=function(){return this.options.cascadeFrom};Object.defineProperty(i.prototype,"cascadeFrom",{get:function(){return this.get_cascadeFrom()},set:function(e){this.set_cascadeFrom(e)},enumerable:true,configurable:true});i.prototype.set_cascadeFrom=function(e){if(e!==this.options.cascadeFrom){this.setCascadeFrom(e);this.updateItems()}};i.prototype.get_cascadeField=function(){return Q.coalesce(this.options.cascadeField,this.options.cascadeFrom)};Object.defineProperty(i.prototype,"cascadeField",{get:function(){return this.get_cascadeField()},set:function(e){this.set_cascadeField(e)},enumerable:true,configurable:true});i.prototype.set_cascadeField=function(e){this.options.cascadeField=e};i.prototype.get_cascadeValue=function(){return this.options.cascadeValue};Object.defineProperty(i.prototype,"cascadeValue",{get:function(){return this.get_cascadeValue()},set:function(e){this.set_cascadeValue(e)},enumerable:true,configurable:true});i.prototype.set_cascadeValue=function(e){if(this.options.cascadeValue!==e){this.options.cascadeValue=e;this.set_value(null);this.updateItems()}};i.prototype.get_filterField=function(){return this.options.filterField};Object.defineProperty(i.prototype,"filterField",{get:function(){return this.get_filterField()},set:function(e){this.set_filterField(e)},enumerable:true,configurable:true});i.prototype.set_filterField=function(e){this.options.filterField=e};i.prototype.get_filterValue=function(){return this.options.filterValue};Object.defineProperty(i.prototype,"filterValue",{get:function(){return this.get_filterValue()},set:function(e){this.set_filterValue(e)},enumerable:true,configurable:true});i.prototype.set_filterValue=function(e){if(this.options.filterValue!==e){this.options.filterValue=e;this.set_value(null);this.updateItems()}};i.prototype.cascadeItems=function(t){var i=this.get_cascadeValue();if(i==null||i===""){if(!Q.isEmptyOrNull(this.get_cascadeField())){return[]}return t}var r=i.toString();var n=this.get_cascadeField();return t.filter(function(t){var i=Q.coalesce(t[n],e.ReflectionUtils.getPropertyValue(t,n));return!!(i!=null&&i.toString()===r)})};i.prototype.filterItems=function(t){var i=this.get_filterValue();if(i==null||i===""){return t}var r=i.toString();var n=this.get_filterField();return t.filter(function(t){var i=Q.coalesce(t[n],e.ReflectionUtils.getPropertyValue(t,n));return!!(i!=null&&i.toString()===r)})};i.prototype.updateItems=function(){};i.prototype.getDialogTypeKey=function(){if(this.options.dialogType!=null){return this.options.dialogType}return null};i.prototype.createEditDialog=function(t){var i=this.getDialogTypeKey();var r=e.DialogTypeRegistry.get(i);e.Widget.create({type:r,init:function(e){return t(e)}})};i.prototype.initNewEntity=function(e){if(!Q.isEmptyOrNull(this.get_cascadeField())){e[this.get_cascadeField()]=this.get_cascadeValue()}if(!Q.isEmptyOrNull(this.get_filterField())){e[this.get_filterField()]=this.get_filterValue()}if(this.onInitNewEntity!=null){this.onInitNewEntity(e)}};i.prototype.setEditDialogReadOnly=function(e){e.element&&e.element.find(".tool-button.delete-button").addClass("disabled").unbind("click")};i.prototype.editDialogDataChange=function(){};i.prototype.setTermOnNewEntity=function(e,t){};i.prototype.inplaceCreateClick=function(t){var i=this;if(this.get_readOnly()&&(this.isMultiple()&&!t["editItem"]||!this.value))return;this.createEditDialog(function(r){if(i.get_readOnly())i.setEditDialogReadOnly(r);e.SubDialogHelper.bindToDataChange(r,i,function(e,t){i.editDialogDataChange();i.updateItems();i.lastCreateTerm=null;if((t.type==="create"||t.type==="update")&&t.entityId!=null){var r=t.entityId.toString();if(i.isMultiple()){var n=i.get_values().slice();if(n.indexOf(r)<0){n.push(r)}i.set_values(null);i.set_values(n.slice())}else{i.set_value(null);i.set_value(r)}}else if(i.isMultiple()&&t.type==="delete"&&t.entityId!=null){var a=t.entityId.toString();var o=i.get_values().slice();var l=o.indexOf(a);if(l>=0)o.splice(l,1);i.set_values(o.slice())}else if(!i.isMultiple()){i.set_value(null)}},true);var n=t["editItem"];if(n!=null){r.load(n,function(){r.dialogOpen(i.openDialogAsPanel)},null)}else if(i.isMultiple()||Q.isEmptyOrNull(i.get_value())){var a={};i.setTermOnNewEntity(a,Q.trimToEmpty(i.lastCreateTerm));i.initNewEntity(a);r.load(a,function(){r.dialogOpen(i.openDialogAsPanel)},null)}else{r.load(i.get_value(),function(){r.dialogOpen(i.openDialogAsPanel)},null)}})};var r;i=r=__decorate([e.Decorators.registerClass("Serenity.Select2Editor",[e.ISetEditValue,e.IGetEditValue,e.IStringValue,e.IReadOnly]),e.Decorators.element('<input type="hidden"/>')],i);return i}(e.Widget);e.Select2Editor=t})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(t){__extends(i,t);function i(e,i){var r=t.call(this,e,i)||this;r.updateItems();return r}i.prototype.getItems=function(){return this.options.items||[]};i.prototype.emptyItemText=function(){if(!Q.isEmptyOrNull(this.options.emptyOptionText)){return this.options.emptyOptionText}return t.prototype.emptyItemText.call(this)};i.prototype.updateItems=function(){var e=this.getItems();this.clearItems();if(e.length>0){var t=typeof e[0]==="string";for(var i=0,r=e;i<r.length;i++){var n=r[i];var a=t?n:n[0];var o=t?n:Q.coalesce(n[1],n[0]);this.addOption(a,o,n,false)}}};i=__decorate([e.Decorators.registerClass("Serenity.SelectEditor")],i);return i}(e.Select2Editor);e.SelectEditor=t})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(t){__extends(i,t);function i(e,i){var r=t.call(this,e,i)||this;r.updateItems();return r}i.prototype.getItems=function(){var e=this.options;if(e.items!=null&&e.items.length>=1){return e.items}var t=[];var i=(new Date).getFullYear();var r=(new Date).getFullYear();e.minYear=Q.coalesce(e.minYear,"-10").toString();if(Q.startsWith(e.minYear,"-")){i-=parseInt(e.minYear.substr(1),10)}else if(Q.startsWith(e.minYear,"+")){i+=parseInt(e.minYear.substr(1),10)}else{i=parseInt(e.minYear,10)}e.maxYear=Q.coalesce(e.maxYear,"+10").toString();if(Q.startsWith(e.maxYear,"-")){r-=parseInt(e.maxYear.substr(1),10)}else if(Q.startsWith(e.maxYear,"+")){r+=parseInt(e.maxYear.substr(1),10)}else{r=parseInt(e.maxYear,10)}if(e.descending){for(var n=r;n>=i;n--){t.push(n.toString())}}else{for(var a=i;a<=r;a++){t.push(a.toString())}}return t};i=__decorate([e.Decorators.registerEditor("Serenity.DateYearEditor")],i);return i}(e.SelectEditor);e.DateYearEditor=t})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(t){__extends(i,t);function i(e,i){var r=t.call(this,e,i)||this;r.updateItems();return r}i.prototype.updateItems=function(){this.clearItems();var t=this.options.enumType||e.EnumTypeRegistry.get(this.options.enumKey);var i=this.options.enumKey;if(i==null&&t!=null){var r=Q.getAttributes(t,e.EnumKeyAttribute,false);if(r.length>0){i=r[0].value}}var n=Q.Enum.getValues(t);for(var a=0,o=n;a<o.length;a++){var l=o[a];var s=Q.Enum.toString(t,l);this.addOption(parseInt(l,10).toString(),Q.coalesce(Q.tryGetText("Enums."+i+"."+s),s),null,false)}};i.prototype.allowClear=function(){return Q.coalesce(this.options.allowClear,true)};i=__decorate([e.Decorators.registerEditor("Serenity.EnumEditor")],i);return i}(e.Select2Editor);e.EnumEditor=t})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(t){__extends(i,t);function i(e,i){var r=t.call(this,e,i)||this;if(!r.hasAsyncSource()){r.updateItems();var n=r;Q.ScriptData.bindToChange("Lookup."+r.getLookupKey(),r.uniqueName,function(){n.updateItems()})}return r}i.prototype.hasAsyncSource=function(){return!!this.options.async};i.prototype.destroy=function(){if(!this.hasAsyncSource())Q.ScriptData.unbindFromChange(this.uniqueName);t.prototype.destroy.call(this)};i.prototype.getLookupKey=function(){if(this.options.lookupKey!=null){return this.options.lookupKey}var e=Q.getTypeFullName(Q.getInstanceType(this));var t=e.indexOf(".");if(t>=0){e=e.substring(t+1)}if(Q.endsWith(e,"Editor")){e=e.substr(0,e.length-6)}return e};i.prototype.getLookupAsync=function(){return Q.getLookupAsync(this.getLookupKey())};i.prototype.getLookup=function(){return Q.getLookup(this.getLookupKey())};i.prototype.getItems=function(e){return this.filterItems(this.cascadeItems(e.items))};i.prototype.getIdField=function(){return this.lookup!=null?this.lookup.idField:t.prototype.getIdField.call(this)};i.prototype.getItemText=function(e,i){if(i==null)return t.prototype.itemText.call(this,e);var r=i.textFormatter?i.textFormatter(e):e[i.textField];return r==null?"":r.toString()};i.prototype.mapItem=function(e){return{id:this.itemId(e),text:this.getItemText(e,this.lookup),disabled:this.getItemDisabled(e,this.lookup),source:e}};i.prototype.getItemDisabled=function(e,i){return t.prototype.itemDisabled.call(this,e)};i.prototype.updateItems=function(){this.clearItems();this.lookup=this.getLookup();var e=this.getItems(this.lookup);for(var t=0,i=e;t<i.length;t++){var r=i[t];this.addItem(this.mapItem(r))}};i.prototype.asyncSearch=function(t,i){var r=this;return this.getLookupAsync().then(function(n){r.lookup=n;var a=r.getItems(r.lookup);if(t.idList!=null){a=a.filter(function(e){return t.idList.indexOf(r.itemId(e))>=0})}function o(e){return this.getItemText(e,this.lookup)}a=e.Select2Editor.filterByText(a,o.bind(r),t.searchTerm);i({items:a.slice(t.skip,t.take),more:a.length>=t.take})})};i.prototype.getDialogTypeKey=function(){var e=t.prototype.getDialogTypeKey.call(this);if(e)return e;return this.getLookupKey()};i.prototype.setCreateTermOnNewEntity=function(e,t){e[this.getLookup().textField]=t};i.prototype.editDialogDataChange=function(){Q.reloadLookup(this.getLookupKey())};i=__decorate([e.Decorators.registerEditor("Serenity.LookupEditorBase")],i);return i}(e.Select2Editor);e.LookupEditorBase=t;var i=function(t){__extends(i,t);function i(e,i){return t.call(this,e,i)||this}i=__decorate([e.Decorators.registerEditor("Serenity.LookupEditor")],i);return i}(t);e.LookupEditor=i})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(t){__extends(i,t);function i(e,i){return t.call(this,e,i)||this}i.prototype.getDialogTypeKey=function(){var e=t.prototype.getDialogTypeKey.call(this);if(e)return e;var i=this.getService();if(Q.startsWith(i,"~/Services/"))i=i.substr("~/Services/".length);if(i.split("/").length==3)i=i.substr(0,i.lastIndexOf("/"));return i.replace("/",".")};i.prototype.getService=function(){return this.options.service};i.prototype.getServiceUrl=function(){var e=this.getService();if(e==null)throw new Error("ServiceLookupEditor requires 'service' option to be configured!");if(!Q.startsWith(e,"~")&&!Q.startsWith(e,"/")&&e.indexOf("://")<0)e="~/Services/"+e;if(Q.startsWith(e,"~"))e=Q.resolveUrl(e);return e};i.prototype.getIncludeColumns=function(){var e=this.options.includeColumns||[];var t=this.getIdField();if(t&&e.indexOf(t)<0)e.push(t);var i=this.getTextField();if(i&&e.indexOf(i)<0)e.push(i);return e};i.prototype.getSort=function(){return this.options.sort||(this.getTextField()?[this.getTextField()]:null)};i.prototype.getCascadeCriteria=function(){var e=this.get_cascadeValue();if(e==null||e===""){if(!Q.isEmptyOrNull(this.get_cascadeField())){return["1","=","0"]}return null}var t=this.get_cascadeField();return[[t],"=",e]};i.prototype.getFilterCriteria=function(){var e=this.get_filterValue();if(e==null||e===""){return null}var t=this.get_filterField();return[[t],"=",e]};i.prototype.getIdListCriteria=function(e){if(e==null)return null;if(e.length==0)return["0","=","1"];var t=this.getIdField();if(t==null)throw new Error("ServiceLookupEditor requires 'idField' option to be configured!");return[[t],"in",[e]]};i.prototype.getCriteria=function(t){return e.Criteria.and(e.Criteria.and(this.getIdListCriteria(t.idList),this.options.criteria),e.Criteria.and(this.getCascadeCriteria(),this.getFilterCriteria()))};i.prototype.getListRequest=function(e){var t={};if(e.searchTerm)t.ContainsText=e.searchTerm;t.Sort=this.getSort();t.ColumnSelection=this.options.columnSelection||1;t.IncludeColumns=this.getIncludeColumns();t.ExcludeColumns=this.options.excludeColumns;t.ContainsField=this.options.containsField;t.EqualityFilter=this.options.equalityFilter;t.Criteria=this.getCriteria(e);t.Skip=e.skip||0;t.Take=e.take?e.checkMore?e.take+1:e.take:0;t.IncludeDeleted=this.options.includeDeleted;t.ExcludeTotalCount=true;return t};i.prototype.getServiceCallOptions=function(e,t){return{blockUI:false,url:this.getServiceUrl(),request:this.getListRequest(e),onSuccess:function(i){var r=i.Entities||[];if(r&&e.take&&e.checkMore&&i.Entities.length>r.length)r=r.slice(0,e.take);t({items:r.slice(0,e.take),more:e.checkMore&&e.take&&r.length>e.take})}}};i.prototype.hasAsyncSource=function(){return true};i.prototype.asyncSearch=function(e,t){var i=this.getServiceCallOptions(e,t);return Q.serviceCall(i)};i=__decorate([e.Decorators.registerEditor("Serenity.ServiceLookupEditorBase")],i);return i}(e.Select2Editor);e.ServiceLookupEditorBase=t;var i=function(t){__extends(i,t);function i(e,i){return t.call(this,e,i)||this}i=__decorate([e.Decorators.registerEditor("Serenity.ServiceLookupEditor")],i);return i}(t);e.ServiceLookupEditor=i})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(t){__extends(i,t);function i(i,n){var a=t.call(this,i,n)||this;a._instanceReady=false;r.includeCKEditor();var o=i.attr("id");if(Q.isTrimmedEmpty(o)){i.attr("id",a.uniqueName);o=a.uniqueName}if(a.options.cols!=null)i.attr("cols",a.options.cols);if(a.options.rows!=null)i.attr("rows",a.options.rows);a.addValidationRule(a.uniqueName,function(e){if(e.hasClass("required")){var t=Q.trimToNull(a.get_value());if(t==null)return Q.text("Validation.Required")}return null});e.LazyLoadHelper.executeOnceWhenShown(a.element,function(){var e=a.getConfig();window["CKEDITOR"]&&window["CKEDITOR"].replace(o,e)});return a}r=i;i.prototype.instanceReady=function(e){this._instanceReady=true;$(e.editor.container.$).addClass(this.element.attr("class"));this.element.addClass("select2-offscreen").css("display","block");e.editor.setData(this.element.val());e.editor.setReadOnly(this.get_readOnly())};i.prototype.getLanguage=function(){if(!window["CKEDITOR"])return"en";var e=window["CKEDITOR"];var t=Q.coalesce(Q.trimToNull($("html").attr("lang")),"en");if(!!e.lang.languages[t]){return t}if(t.indexOf(String.fromCharCode(45))>=0){t=t.split(String.fromCharCode(45))[0]}if(!!e.lang.languages[t]){return t}return"en"};i.prototype.getConfig=function(){var e=this;return{customConfig:"",language:this.getLanguage(),bodyClass:"s-HtmlContentBody",on:{instanceReady:function(t){return e.instanceReady(t)},change:function(t){t.editor.updateElement();e.element.triggerHandler("change")}},toolbarGroups:[{name:"clipboard",groups:["clipboard","undo"]},{name:"editing",groups:["find","selection","spellchecker"]},{name:"insert",groups:["links","insert","blocks","bidi","list","indent"]},{name:"forms",groups:["forms","mode","document","doctools","others","about","tools"]},{name:"colors"},{name:"basicstyles",groups:["basicstyles","cleanup"]},{name:"align"},{name:"styles"}],removeButtons:"SpecialChar,Anchor,Subscript,Styles",format_tags:"p;h1;h2;h3;pre",removeDialogTabs:"image:advanced;link:advanced",removePlugins:"uploadimage,image2",contentsCss:Q.resolveUrl("~/Content/site/site.htmlcontent.css"),entities:false,entities_latin:false,entities_greek:false,autoUpdateElement:true,height:this.options.rows==null||this.options.rows===0?null:this.options.rows*20+"px"}};i.prototype.getEditorInstance=function(){var e=this.element.attr("id");return window["CKEDITOR"].instances[e]};i.prototype.destroy=function(){var e=this.getEditorInstance();e&&e.destroy(true);t.prototype.destroy.call(this)};i.prototype.get_value=function(){var e=this.getEditorInstance();if(this._instanceReady&&e){return e.getData()}else{return this.element.val()}};Object.defineProperty(i.prototype,"value",{get:function(){return this.get_value()},set:function(e){this.set_value(e)},enumerable:true,configurable:true});i.prototype.set_value=function(e){var t=this.getEditorInstance();this.element.val(e);if(this._instanceReady&&t)t.setData(e)};i.prototype.get_readOnly=function(){return!Q.isEmptyOrNull(this.element.attr("disabled"))};i.prototype.set_readOnly=function(e){if(this.get_readOnly()!==e){if(e){this.element.attr("disabled","disabled")}else{this.element.removeAttr("disabled")}var t=this.getEditorInstance();if(this._instanceReady&&t)t.setReadOnly(e)}};i.includeCKEditor=function(){if(window["CKEDITOR"]){return}var e=$("#CKEditorScript");if(e.length>0){return}$("<script/>").attr("type","text/javascript").attr("id","CKEditorScript").attr("src",Q.resolveUrl("~/Scripts/CKEditor/ckeditor.js?v="+r.CKEditorVer)).appendTo(window.document.head)};var r;i.CKEditorVer="4.7.1";i=r=__decorate([e.Decorators.registerEditor("Serenity.HtmlContentEditor",[e.IStringValue,e.IReadOnly]),e.Decorators.element("<textarea/>")],i);return i}(e.Widget);e.HtmlContentEditor=t;var i=function(t){__extends(i,t);function i(e,i){return t.call(this,e,i)||this}i.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);e.removeButtons+=",Cut,Copy,Paste,BulletedList,NumberedList,"+"Indent,Outdent,SpecialChar,Subscript,Superscript,Styles,PasteText,"+"PasteFromWord,Strike,Link,Unlink,CreatePlaceholder,Image,Table,"+"HorizontalRule,Source,Maximize,Format,Font,FontSize,Anchor,Blockquote,"+"CreatePlaceholder,BGColor,JustifyLeft,JustifyCenter,"+"JustifyRight,JustifyBlock,Superscript,RemoveFormat";e.removePlugins="elementspath,uploadimage,image2";return e};i=__decorate([e.Decorators.registerEditor("Serenity.HtmlNoteContentEditor")],i);return i}(t);e.HtmlNoteContentEditor=i;var r=function(t){__extends(i,t);function i(e,i){return t.call(this,e,i)||this}i.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);e.removeButtons+=",Cut,Copy,Paste,BulletedList,NumberedList,"+"Indent,Outdent,SpecialChar,Subscript,Superscript,Styles,"+"PasteText,PasteFromWord,Strike,Link,Unlink,CreatePlaceholder,"+"Image,Table,HorizontalRule,Source,Maximize,Format,Font,FontSize,"+"Anchor,Blockquote,CreatePlaceholder,BGColor,JustifyLeft,JustifyCenter,"+"JustifyRight,JustifyBlock,Superscript,RemoveFormat";e.removePlugins="elementspath,uploadimage,image2";return e};i=__decorate([e.Decorators.registerEditor("Serenity.HtmlReportContentEditor")],i);return i}(t);e.HtmlReportContentEditor=r})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(t){__extends(i,t);function i(i,r){var n=t.call(this,i,r)||this;if(!r||r.allowNonImage==null)n.options.allowNonImage=true;i.addClass("s-FileUploadEditor");if(Q.isEmptyOrNull(n.options.originalNameProperty))i.addClass("hide-original-name");n.toolbar=new e.Toolbar($("<div/>").appendTo(n.element),{buttons:n.getToolButtons()});var a=$("<div><div></div></div>").addClass("upload-progress").prependTo(n.toolbar.element);var o=n.getUploadInputOptions();n.uploadInput=e.UploadHelper.addUploadInput(o);n.fileSymbols=$("<ul/>").appendTo(n.element);n.updateInterface();return n}i.prototype.getUploadInputOptions=function(){var t=this;return{container:this.toolbar.findButton("add-file-button"),zone:this.element,inputName:this.uniqueName,progress:this.progress,fileDone:function(i,r,n){if(!e.UploadHelper.checkImageConstraints(i,t.options)){return}var a={OriginalName:r,Filename:i.TemporaryFile};t.entity=a;t.populate();t.updateInterface()}}};i.prototype.addFileButtonText=function(){return Q.text("Controls.ImageUpload.AddFileButton")};i.prototype.getToolButtons=function(){var e=this;return[{title:this.addFileButtonText(),cssClass:"add-file-button",onClick:function(){}},{title:"",hint:Q.text("Controls.ImageUpload.DeleteButtonHint"),cssClass:"delete-button",onClick:function(){e.entity=null;e.populate();e.updateInterface()}}]};i.prototype.populate=function(){var t=this.options.displayFileName||!Q.isTrimmedEmpty(this.options.originalNameProperty);if(this.entity==null){e.UploadHelper.populateFileSymbols(this.fileSymbols,null,t,this.options.urlPrefix)}else{e.UploadHelper.populateFileSymbols(this.fileSymbols,[this.entity],t,this.options.urlPrefix)}};i.prototype.updateInterface=function(){var e=this.toolbar.findButton("add-file-button");var t=this.toolbar.findButton("delete-button");e.toggleClass("disabled",this.get_readOnly());t.toggleClass("disabled",this.get_readOnly()||this.entity==null)};i.prototype.get_readOnly=function(){return this.uploadInput.attr("disabled")!=null};i.prototype.set_readOnly=function(e){if(this.get_readOnly()!==e){if(e){this.uploadInput.attr("disabled","disabled").fileupload("disable")}else{this.uploadInput.removeAttr("disabled").fileupload("enable")}this.updateInterface()}};i.prototype.get_value=function(){if(this.entity==null){return null}var e=Q.extend({},this.entity);return e};Object.defineProperty(i.prototype,"value",{get:function(){return this.get_value()},set:function(e){this.set_value(e)},enumerable:true,configurable:true});i.prototype.set_value=function(e){if(e!=null){if(e.Filename==null){this.entity=null}else{this.entity=Q.extend({},e)}}else{this.entity=null}this.populate();this.updateInterface()};i.prototype.getEditValue=function(e,t){t[e.name]=this.entity==null?null:Q.trimToNull(this.entity.Filename)};i.prototype.setEditValue=function(e,t){var i={};i.Filename=e[t.name];if(Q.isEmptyOrNull(this.options.originalNameProperty)){if(this.options.displayFileName){var r=Q.coalesce(i.Filename,"");var n=Q.replaceAll(r,"\\","/").lastIndexOf("/");if(n>=0){i.OriginalName=r.substr(n+1)}else{i.OriginalName=r}}}else{i.OriginalName=e[this.options.originalNameProperty]}this.set_value(i)};i=__decorate([e.Decorators.registerEditor("Serenity.FileUploadEditor",[e.IReadOnly]),e.Decorators.element("<div/>")],i);return i}(e.Widget);e.FileUploadEditor=t;var i=function(t){__extends(i,t);function i(e,i){var r=t.call(this,e,i)||this;if(i&&i.allowNonImage==null)r.options.allowNonImage=false;e.addClass("s-ImageUploadEditor");return r}i=__decorate([e.Decorators.registerEditor("Serenity.ImageUploadEditor")],i);return i}(t);e.ImageUploadEditor=i;var r=function(t){__extends(i,t);function i(i,r){var n=t.call(this,i,r)||this;n.entities=[];i.addClass("s-MultipleFileUploadEditor");var a=n;n.toolbar=new e.Toolbar($("<div/>").appendTo(n.element),{buttons:n.getToolButtons()});var o=$("<div><div></div></div>").addClass("upload-progress").prependTo(n.toolbar.element);var l=n.toolbar.findButton("add-file-button");n.uploadInput=e.UploadHelper.addUploadInput({container:l,zone:n.element,inputName:n.uniqueName,progress:o,fileDone:function(t,i,r){if(!e.UploadHelper.checkImageConstraints(t,n.options)){return}var o={OriginalName:i,Filename:t.TemporaryFile};a.entities.push(o);a.populate();a.updateInterface()}});n.fileSymbols=$("<ul/>").appendTo(n.element);n.updateInterface();return n}i.prototype.addFileButtonText=function(){return Q.text("Controls.ImageUpload.AddFileButton")};i.prototype.getToolButtons=function(){return[{title:this.addFileButtonText(),cssClass:"add-file-button",onClick:function(){}}]};i.prototype.populate=function(){var t=this;e.UploadHelper.populateFileSymbols(this.fileSymbols,this.entities,true,this.options.urlPrefix);this.fileSymbols.children().each(function(e,i){var r=e;$("<a class='delete'></a>").appendTo($(i).children(".filename")).click(function(e){e.preventDefault();t.entities.splice(r,1);t.populate()})})};i.prototype.updateInterface=function(){var e=this.toolbar.findButton("add-file-button");e.toggleClass("disabled",this.get_readOnly());this.fileSymbols.find("a.delete").toggle(!this.get_readOnly())};i.prototype.get_readOnly=function(){return this.uploadInput.attr("disabled")!=null};i.prototype.set_readOnly=function(e){if(this.get_readOnly()!==e){if(e){this.uploadInput.attr("disabled","disabled").fileupload("disable")}else{this.uploadInput.removeAttr("disabled").fileupload("enable")}this.updateInterface()}};i.prototype.get_value=function(){return this.entities.map(function(e){return Q.extend({},e)})};Object.defineProperty(i.prototype,"value",{get:function(){return this.get_value()},set:function(e){this.set_value(e)},enumerable:true,configurable:true});i.prototype.set_value=function(e){this.entities=(e||[]).map(function(e){return Q.extend({},e)});this.populate();this.updateInterface()};i.prototype.getEditValue=function(e,t){if(this.jsonEncodeValue){t[e.name]=$.toJSON(this.get_value())}else{t[e.name]=this.get_value()}};i.prototype.setEditValue=function(e,t){var i=e[t.name];if(Q.isInstanceOfType(i,String)){var r=Q.coalesce(Q.trimToNull(i),"[]");if(Q.startsWith(r,"[")&&Q.endsWith(r,"]")){this.set_value($.parseJSON(r))}else{this.set_value([{Filename:r,OriginalName:"UnknownFile"}])}}else{this.set_value(i)}};__decorate([e.Decorators.option()],i.prototype,"jsonEncodeValue",void 0);i=__decorate([e.Decorators.registerEditor("Serenity.MultipleFileUploadEditor",[e.IReadOnly]),e.Decorators.element("<div/>")],i);return i}(e.Widget);e.MultipleFileUploadEditor=r;var n=function(t){__extends(i,t);function i(e,i){var r=t.call(this,e,i)||this;e.addClass("s-MultipleImageUploadEditor");return r}i=__decorate([e.Decorators.registerEditor("Serenity.MultipleImageUploadEditor")],i);return i}(r);e.MultipleImageUploadEditor=n})(Serenity||(Serenity={}));